-----

# Timesheet Processing and Visualisation Utility

This project provides a Python script to process and analyse employee timesheet data from a CSV file, including integration with Monday.com, and an interactive HTML page to visualize the results.

## Features

  - **Process Timesheet Data**: Reads and parses timesheet CSV files to extract relevant data.
  - **Monday.com Integration**: Automatically fetches task details from Monday.com by extracting item IDs from comments.
  - **Multiple CSV Reports**: Generates three different reports from the source data:
      - A **detailed report** with enriched data from Monday.com.
      - A **summary report** aggregating hours by employee and task.
      - A **template-formatted report** for specific import needs.
  - **Interactive Visualisation**: An HTML-based tool to visualise the processed data with interactive bar and pie charts showing hours by employee and task.

-----

## Files

### `timesheet_processor.py`

A command-line script that serves as the core of the project. It handles data processing and report generation. It reads a timesheet CSV, filters for billable tasks, queries the Monday.com API for additional details, and outputs the data into several formatted CSV reports.

### `timesheet_visualizer.html`

A self-contained HTML file for creating interactive visualisations from the generated detailed report (`_detailed.csv`). It allows you to upload the report and view the data as charts directly in your browser.

-----

## Setup and Usage

### 1\. Backend Processor (`timesheet_processor.py`)

#### **Prerequisites**

The script requires Python 3 and the following libraries:

  - pandas
  - requests
  - pytz

You can install them using pip:

```bash
pip install pandas requests pytz
```

#### **Configuration**

**IMPORTANT:** The Monday.com API key is hardcoded in the script. For security, consider replacing this with a more secure method, such as environment variables.

Open `timesheet_processor.py` and find this line:

```python
self.monday_api_key = "eyJhbGciOiJIUzI1NiJ9..." # Hardcoded API key
```

Could you replace the key with your own Monday.com API key?

#### **Running the Script**

Execute the script from your terminal, providing the input file and an optional output directory.

```bash
python timesheet_processor.py <input_csv_file> [output_directory]
```

**Example:**

```bash
# This will process 'my_timesheet.csv' and save reports in the 'output/' folder
python timesheet_processor.py my_timesheet.csv output
```

This will generate three files in the output directory: `_summary.csv`, `_template_format.csv`, and `_detailed.csv`.

### 2\. Frontend Visualizer (`timesheet_visualizer.html`)

The visualizer is designed to work with the `_detailed.csv` file generated by the processor.

1.  Open `timesheet_visualizer.html` in any modern web browser (e.g., Chrome, Firefox).
2.  Click **"Choose File"** and select the `_detailed.csv` file you generated.
3.  Select a **Chart Type** (Bar or Pie) from the dropdown menu.
4.  Click **"Load and Visualise "** to see the charts.

-----

## Contributing

Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.
